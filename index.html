<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ENTRENA COMO UNA CHICA</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gradient-to-b from-pink-100 via-pink-200 to-purple-300 min-h-screen font-sans text-gray-900 p-4">
  <div class="max-w-2xl mx-auto bg-white rounded-2xl shadow-lg p-6">
    <!-- Header -->
    <h1 class="text-4xl font-extrabold text-pink-600 text-center uppercase">ğŸ’ªğŸ½ Entrena como una chica ğŸ’…ğŸ¼</h1>
    <p class="text-center text-pink-500 italic mt-1">Spoiler: significa con ovarios, cabeza y fuego ğŸ”¥ğŸ§ ğŸ‘</p>
    <p class="text-center text-sm text-purple-700 mt-1">By: Anita Dinamita ğŸ’¥</p>
    <div class="w-20 h-1 bg-pink-500 mx-auto mt-4 mb-6 rounded-full"></div>

    <!-- Historial toggle + chart -->
    <div class="text-center mb-4">
      <button id="toggle-history" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-1 rounded">ğŸ“… Mostrar historial</button>
      <div id="historial" class="mt-4 text-left text-sm text-gray-800 bg-pink-100 p-3 rounded hidden"></div>
      <canvas id="progressChart" class="mt-4 hidden"></canvas>
    </div>

    <!-- Formulario -->
    <form id="training-form" class="space-y-4">
      <div id="location-group">
        <label class="block text-pink-700">ğŸ  Â¿DÃ³nde vas a entrenar hoy?</label>
        <select id="location" class="w-full p-2 rounded bg-pink-50">
          <option>Casa sin material</option>
          <option>HabitaciÃ³n con bandas</option>
          <option>Gimnasio con mÃ¡quinas</option>
        </select>
      </div>
      <div id="goal-group">
        <label class="block text-pink-700">ğŸ¯ Â¿QuÃ© quieres trabajar hoy?</label>
        <select id="goal" class="w-full p-2 rounded bg-pink-50">
          <option>Tren inferior</option>
          <option>Tren superior</option>
          <option>GlÃºteos</option>
          <option>Abdomen</option>
          <option>Cuerpo entero</option>
          <option>Movilidad</option>
        </select>
      </div>
      <div>
        <label class="block text-pink-700">ğŸ§—â€â™€ï¸ Â¿CuÃ¡l es tu nivel?</label>
        <select id="level" class="w-full p-2 rounded bg-pink-50">
          <option>Principiante</option>
          <option>Intermedio</option>
          <option>Avanzado</option>
        </select>
      </div>
      <div>
        <label class="block text-pink-700">â± Â¿CuÃ¡nto tiempo tienes hoy?</label>
        <select id="time" class="w-full p-2 rounded bg-pink-50">
          <option>10</option>
          <option>15</option>
          <option>30</option>
          <option>45</option>
          <option>60</option> 
        </select>
      </div>
      <div>
        <label class="block text-pink-700">ğŸ”‹ Nivel de energÃ­a y motivaciÃ³n (1 a 5)</label>
        <select id="energy" class="w-full p-2 rounded bg-pink-50">
          <option>1</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
          <option>5</option>
        </select>
      </div>
      <button type="submit" class="w-full mt-4 bg-pink-500 hover:bg-pink-600 text-white font-bold py-2 px-4 rounded">
        DiseÃ±ar entrenamiento
      </button>
    </form>

    <!-- Sugerencia sesiÃ³n anterior -->
    <div id="suggestion" class="mt-6 text-sm text-purple-800"></div>

    <!-- Resultados -->
    <div id="output" class="mt-6 hidden space-y-6">
      <div id="activation-plan"></div>
      <div id="main-plan"></div>
      <div id="express-plan"></div>
      <div id="progression-plan"></div>
      <div id="challenge-plan"></div>

      <!-- Feedback -->
      <div id="feedback" class="mt-6">
        <h3 class="text-lg font-semibold text-pink-600">ğŸ“ Â¿QuÃ© hiciste hoy?</h3>
        <div id="exercise-checklist" class="space-y-1 mt-2"></div>
        <label class="block mt-3">Â¿CÃ³mo te sentiste al acabar?</label>
        <select id="feeling" class="w-full bg-pink-50 p-2 rounded">
          <option>1 - Fatal</option>
          <option>2 - Cansada</option>
          <option>3 - Normal</option>
          <option>4 - Bien</option>
          <option>5 - Fuerte</option>
        </select>
        <button id="save-feedback" class="mt-4 bg-green-500 text-white px-3 py-1 rounded">Guardar experiencia</button>
      </div>

      <!-- Exportar / Importar -->
      <div class="mt-6 space-y-2 text-center">
        <button onclick="exportarMemoria()" class="bg-yellow-400 hover:bg-yellow-500 text-black px-4 py-1 rounded">ğŸ“¤ Exportar datos</button>
        <input type="file" id="importador" class="mt-2 mx-auto block" />
        <button onclick="importarMemoria()" class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-1 rounded">ğŸ“¥ Importar datos</button>
      </div>

      <!-- Guardar sesiÃ³n -->
      <div class="text-center">
        <button id="save-session" class="mt-6 bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded">
          ğŸ’¾ Guardar esta sesiÃ³n
        </button>
      </div>
    </div>
  </div>

  <script>
  // Utilidades
  function shuffle(arr){ return arr.slice().sort(()=>Math.random()-0.5) }
  function getAlternative(goal){
    if(goal==='Tren inferior') return 'Tren superior + abdomen';
    if(goal==='Tren superior') return 'GlÃºteos o movilidad';
    if(goal==='GlÃºteos')     return 'Cuerpo entero';
    if(goal==='Abdomen')     return 'Movilidad';
    if(goal==='Movilidad')   return 'Cuerpo entero';
    return 'Cuerpo entero';
  }

  // Ejercicios por entorno, nivel y objetivo (resumido aquÃ­)
  const exerciseBankEnv = {
    'Casa sin material': {
      'Principiante': {
        'Tren inferior': ['Sentadilla al aire 3x15','Zancada estÃ¡tica 3x10/pierna'],
        'Tren superior': ['Remo con toalla 3x12','FlexiÃ³n de pared 3x10','Dips en banco 3x12'],
        'GlÃºteos':      ['Puente de glÃºteo 3x15','AbducciÃ³n mariposa 3x20','Hip Thrust mariposa 3x15'],
        'Abdomen':      ['Plancha rodillas 3x20s','Bird Dog 3x12','Marcha en sitio 3x30s'],
        'Cuerpo entero':['Marcha en sitio 3x30s','Jumping Jacks suaves 3x20'],
        'Movilidad':    ['Gato-vaca x10','90/90 x30s']
      },
      'Intermedio': {
        'Tren inferior': ['Sentadilla al aire 4x15','Zancada caminando 4x12/pierna','Peso muerto a una pierna 3x12/pierna','Puente de glÃºteo 4x15','Sentadilla bÃºlgara asistida 3x10/pierna','ElevaciÃ³n de talones 4x20'],
        'Tren superior': ['FlexiÃ³n con rodillas elevadas 3x12','Remo invertido 3x12','Dips en banco 3x15'],
        'GlÃºteos': ['Hip Thrust a una pierna 3x12','Patada glÃºteo en cuadrupedia 3x15','AbducciÃ³n lateral 3x20','Hip Thrust Mariposa 4x15'],
        'Abdomen': ['Crunch bicicleta 3x20','Plancha 3x30s','Levantamiento de piernas 3x15'],
        'Cuerpo entero': ['Burpees 3x10','Mountain climbers 3x30s','Jump squat 3x12'],
        'Movilidad': ['Estiramiento isquiotibiales 3x30s','Rotaciones de cadera x10']
    },
      'Avanzado': {
        'Tren inferior': ['Pistol squat asistida 4x8/pierna','Zancada bÃºlgara 4x10/pierna','Peso muerto a una pierna 4x12/pierna','Puente de glÃºteo con una pierna 4x12/pierna','Sentadilla con salto 3x12','ElevaciÃ³n de talones a una pierna 4x15','Goblet squat improvisado 4x12','Cossack squat 3x10/pierna'],
        'Tren superior': ['FlexiÃ³n declinada 3x12','Remo con toalla con pie elevado 3x12','Fondos en banco con piernas elevadas 3x12'],
        'GlÃºteos': ['Hip Thrust con pie en banco 3x12','Patada glÃºteo en polea improvisada 3x15','AbducciÃ³n con banda y salto 3x15', 'Hip Thrust Mariposa 4x20'],
        'Abdomen': ['Plancha lateral 3x30s/pierna','V-Sit-ups 3x15','Hanging leg raises 3x12'],
        'Cuerpo entero': ['Burpee con salto de cajÃ³n 3x8','Thruster con peso corporal 3x12','Jumping lunges 3x12/pierna'],
      'Movilidad': ['Estiramiento psoas 3x30s/pierna','Puente dinÃ¡mico 3x10']
    }
  },
    'HabitaciÃ³n con bandas': {
      'Principiante': {
        'Tren inferior': ['Sentadilla con banda 3x15','Puente de glÃºteo con banda 3x15'],
        'Tren superior': ['Remo con banda 3x12','Press hombros con banda 3x12','Dips en banco 3x12'],
        'GlÃºteos':      ['Patada glÃºteo con banda 3x20','AbducciÃ³n lateral con banda 3x20','Hip Thrust mariposa 3x15'],
        'Abdomen':      ['Crunch con banda 3x15','Plancha con banda 3x20s'],
        'Cuerpo entero':['Thruster con banda 3x12','Jumping Jacks con banda 3x20'],
        'Movilidad':    ['Gato-vaca x10','90/90 x30s']
      },
      'Intermedio': {
        'Tren inferior': ['Sentadilla con banda 4x15','Zancada estÃ¡tica con banda 4x12/pierna','Puente glÃºteo con banda 4x15','ElevaciÃ³n de talones con banda 4x20'],
        'Tren superior': ['Remo con banda 4x12','Press hombros con banda 4x12','Dips en banco 4x12'],
        'GlÃºteos': ['Patada glÃºteo con banda 4x20','Hip Thrust con banda 4x15','AbducciÃ³n lateral con banda 4x20'],
        'Abdomen': ['Crunch con banda 4x15','Plancha con banda 4x30s','Mountain climbers con banda 4x30s'],
        'Cuerpo entero': ['Thruster con banda 4x12','Jumping Jacks con banda 4x20'],
        'Movilidad': ['Gato-vaca x15','90/90 x45s','Rotaciones de cadera x12'
      ]
    },
    'Avanzado': {
      'Tren inferior': ['Pistol squat asistida con banda 4x8/pierna','Sentadilla bÃºlgara con banda 4x10/pierna','Puente glÃºteo con una pierna y banda 4x12/pierna','Sentadilla con salto con banda 4x12'],
      'Tren superior': ['Remo alto con banda 4x12','Press militar con banda 4x12', 'Fondos en banco con banda 4x12'],
      'GlÃºteos': ['Hip Thrust en una pierna con banda 4x12/pierna','Patada glÃºteo con banda y salto 4x15','AbducciÃ³n lateral con salto de banda 4x15'],
      'Abdomen': ['Plancha lateral con banda 4x30s/pierna','V-Ups con banda 4x15','Crunch bicicleta con banda 4x20'],
      'Cuerpo entero': ['Burpees con salto y banda 4x10','Thruster con banda a una pierna 4x12','Mountain climbers con banda 4x30s'],
      'Movilidad': ['Estiramiento de psoas con banda 4x30s','Puente dinÃ¡mico con banda 4x12','Rotaciones dinÃ¡micas de cadera x12']
    }
  },

    'Gimnasio con mÃ¡quinas': {
      'Principiante': {
        'Tren inferior': ['Prensa de piernas 3x15','ExtensiÃ³n de cuÃ¡driceps 3x12'],
        'Tren superior': ['JalÃ³n al pecho 3x12','Press banca mancuernas 3x10','Dips en banco 3x12'],
        'GlÃºteos':      ['AbducciÃ³n cadera mÃ¡quina 3x15','Hip Thrust en smith 3x12','Hip Thrust mariposa 3x15'],
        'Abdomen':      ['Crunch mÃ¡quina 3x15','Plancha 3x20s'],
        'Cuerpo entero':['Kettlebell swing 3x15','Burpee con salto 3x10'],
        'Movilidad':    ['Gato-vaca x10','90/90 x30s']
      },
      'Intermedio': {
        'Tren inferior': ['Prensa de piernas 4x15','Curl femoral tumbado 4x12','ExtensiÃ³n de cuÃ¡driceps 4x12'],
        'Tren superior': ['JalÃ³n al pecho 4x12','Press banca mÃ¡quina 4x10','Remo sentado 4x12'],
        'GlÃºteos': ['Hip Thrust en Smith 4x12','AbducciÃ³n cadera mÃ¡quina 4x15','Patada glÃºteo mÃ¡quina 4x20'],
        'Abdomen': ['Crunch mÃ¡quina 4x15','Plancha en bosu 4x30s','ElevaciÃ³n de piernas colgado 4x12'],
        'Cuerpo entero': ['Kettlebell swing 4x15','Burpee con caja 4x10','Thruster con barra 4x12'],
        'Movilidad': ['Gato-vaca x15','90/90 x45s','Rotaciones de tronco x12']
    },
      'Avanzado': {
        'Tren inferior': ['Sentadilla en mÃ¡quina hack 4x12','Peso muerto rumano 4x12', 'Zancada bÃºlgara con mancuernas 4x10/pierna'],
        'Tren superior': ['Press banca barra 4x10','Dominadas asistidas 4x8','Remo con barra T 4x12'],
        'GlÃºteos': ['Hip Thrust con barra 4x12','AbducciÃ³n de cadera en mÃ¡quina 4x15','Patada glÃºteo en polea baja 4x15'],
        'Abdomen': ['Crunch en banco declinado 4x15','Plancha con apoyo alterno 4x30s','Levantamiento de rodillas en paralelas 4x12'],
        'Cuerpo entero': ['Clean and press 4x8','Burpee con salto de cajÃ³n 4x10','Thruster con barra 4x12'],
        'Movilidad': ['Estiramiento dinÃ¡mico de isquiotibiales 4x30s','RotaciÃ³n de columna en banco 4x12','Estiramiento de psoas 4x30s'
      ]
    }
    },
  };

  // Explicaciones
  const exerciseInfo = {
    'Marcha en sitio 3x30s': 'Levanta las rodillas alternas sin avanzar, mantÃ©n core activo.',
    'Bird Dog 3x12':         'En cuadrupedia, extiende brazo y pierna contrarios, mantÃ©n core firme.',
    'Hip Thrust mariposa 3x15':'Boca arriba, plantas juntas; eleva cadera apretando glÃºteos.',
    'Dips en banco 3x12':    'Apoya manos en banco, baja cuerpo con codos pegados al torso.',
    'Crunch con banda 3x15': 'Boca arriba, banda bajo pies; haz crunch elevando hombros.',
    'V-Sit-ups': 'AcuÃ©state boca arriba con brazos y piernas extendidos. Contrae el core y eleva simultÃ¡neamente el torso y las piernas formando una â€œVâ€, acercando manos a pies. MantÃ©n la espalda recta y baja controlado sin tocar suelo.',
    'RespiraciÃ³n nasal profunda':'Inhala profundamente por la nariz expandiendo abdomen, exhala controlado por la boca manteniendo el core firme y repite con ritmo constante.',
    'Plancha rodillas': 'En posiciÃ³n de plancha apoyando antebrazos y rodillas, alinea cabeza, hombros y cadera y mantÃ©n el core activo durante toda la serie.',
    'Sentadilla al aire': 'PÃ¡rate con los pies al ancho de hombros, baja cadera como si te sentaras, mantÃ©n rodillas alineadas con los pies y sube apretando glÃºteos.',
    'Zancada estÃ¡tica': 'Da un gran paso adelante, baja ambas rodillas hasta 90Â°, empuja con el talÃ³n delantero para volver a la posiciÃ³n inicial.',
    'FlexiÃ³n de rodillas': 'En posiciÃ³n de plancha con rodillas apoyadas, baja el pecho manteniendo el core firme y sube estirando brazos.',
    'Remo invertido': 'ColÃ³cate debajo de una barra, coge con manos al ancho de hombros y tira del pecho hacia la barra manteniendo el cuerpo recto.',
    'Fondos en banco': 'Manos apoyadas detrÃ¡s en el banco, flexiona codos manteniÃ©ndolos cerca del torso y extiende los brazos para subir.',
    'Puente de glÃºteo': 'Tumbado boca arriba con plantas apoyadas, eleva cadera apretando glÃºteos y baja controlado sin apoyar lumbares.',
    'Patada glÃºteo en cuadrupedia': 'En cuatro apoyos, extiende una pierna hacia atrÃ¡s y arriba manteniendo la rodilla flexionada, vuelve y alterna.',
    'AbducciÃ³n lateral': 'De pie o tumbado de lado, eleva lateralmente la pierna manteniendo el cuerpo alineado y baja sin apoyar.',
    'Crunch bicicleta': 'Tumbado boca arriba, lleva codo y rodilla opuestos acercÃ¡ndolos mientras pedaleas en el aire.',
    'Plancha': 'Apoya antebrazos y pies, mantÃ©n cuerpo recto como tabla, aprieta core y glÃºteos durante toda la serie.',
    'Levantamiento de piernas': 'Tumbado boca arriba, eleva piernas juntas manteniÃ©ndolas rectas hasta 90Â° y baja controlando el descenso.',
    'Burpees': 'Desde de pie, agÃ¡chate, pasa a plancha, haz un push-up, vuelve pies bajo caderas y salta explosivamente.',
    'Mountain climbers': 'En plancha alta, lleva rodillas alternas al pecho de forma rÃ¡pida mientras mantienes el core firme.',
    'Jumping jacks': 'De pie, salta abriendo piernas y brazos lateralmente y vuelve a posiciÃ³n inicial en cada repeticiÃ³n.',
    'Estiramiento isquiotibiales': 'SiÃ©ntate con piernas extendidas, inclÃ­nate desde la cadera hasta notar el estiramiento en la parte posterior.',
    'Rotaciones de cadera': 'De pie, manos en cintura, haz cÃ­rculos amplios con la pelvis en ambas direcciones.',
    'Zancada caminando': 'Avanza dando zancadas largas y fluidas, bajando rodillas a 90Â° y caminando activo.',
    'Peso muerto a una pierna': 'Apoya un pie, inclÃ­nate hacia delante llevando la cadera atrÃ¡s y eleva la pierna contraria recta hacia atrÃ¡s.',
    'Sentadilla bÃºlgara asistida': 'Con un pie en un banco tras de ti, baja hasta 90Â° con la pierna delantera y sube manteniendo torso erguido.',
    'ElevaciÃ³n de talones': 'De pie, sube y baja sobre las puntas de los pies sintiendo la contracciÃ³n de gemelos.',
    'FlexiÃ³n con rodillas elevadas': 'FlexiÃ³n apoyando rodillas en el suelo pero elevando ligeramente la cadera para aumentar rango en el core.',
    'Jump squat': 'Baja en sentadilla y salta vertical explosiÂ­vamente, aterriza suave y repite.',
    'Goblet squat improvisado': 'Sujeta un objeto pesado frente al pecho, baja en sentadilla manteniendo codos cerca y sube con control.',
    'Cossack squat': 'De pie separa piernas muy ancho, desliza lateralmente el peso a un lado manteniendo la otra pierna estirada.',
    'FlexiÃ³n declinada': 'Manos en superficie elevada y pies en el suelo, haz flexiÃ³n para trabajar parte alta del pecho.',
    'Remo con toalla con pie elevado': 'Ancla una toalla firme en superficie, tira usando remo a un brazo manteniendo pie de apoyo elevado para inestabilidad.',
    'Fondos en banco con piernas elevadas': 'Manos en banco, pies en otro soporte mÃ¡s alto, baja cuerpo flexionando codos y sube apretando trÃ­ceps.',
    'Hip Thrust a una pierna': 'Tumbado boca arriba, eleva cadera apoyando un pie y mantÃ©n la otra pierna recta en el aire.',
    'Hip Thrust con banda': 'Como el thrust, pero con banda por encima de rodillas para mayor resistencia en abductores.',
    'Hip Thrust en Smith': 'Realiza hip thrust en mÃ¡quina Smith para mayor estabilidad en la barra y carga progresiva.',
    'Hip Thrust con barra': 'Con una barra sobre caderas, apoya espalda alta en banco y eleva cadera apretando glÃºteos.',
    'AbducciÃ³n cadera mÃ¡quina': 'En mÃ¡quina especÃ­fica, separa piernas contra resistencia manteniendo torso erguido.',
    'Patada glÃºteo mÃ¡quina': 'En mÃ¡quina de polea baja, tira con la pierna hacia atrÃ¡s manteniendo rodilla flexionada.',
    'Patada glÃºteo en polea improvisada': 'Engancha toalla a polea baja y, en cuadrupedia, empuja la pierna hacia atrÃ¡s.',
    'AbducciÃ³n con banda y salto': 'Coloca banda por encima de rodillas, haz salto lateral abriendo caderas activando glÃºteos.',
    'Plancha lateral': 'Apoya antebrazo y canto del pie, mantÃ©n cuerpo alineado y eleva cadera manteniendo core contraÃ­do.',
    'Hanging leg raises': 'Colgado de barra, eleva piernas juntas manteniendo rodillas rectas hasta 90Â° y baja controlando.',
    'Jumping lunges': 'Alterna zancadas saltando y cambiando pierna de apoyo en cada salto.',
    'Puente dinÃ¡mico': 'Tumbado boca arriba, sube y baja cadera de forma controlada con ritmo constante.',
    'Estiramiento psoas': 'Avanza una pierna en semi-zancada y empuja cadera hacia delante para estirar psoas.',
    'Marcha en sitio': 'Levanta las rodillas alternas sin avanzar, mantÃ©n core activo.',
    'Bird Dog': 'En cuadrupedia, extiende brazo y pierna contrarios, mantÃ©n core firme.',
    'Sentadilla con banda': 'PÃ¡rate con banda por encima de rodillas y realiza sentadilla manteniendo tensiÃ³n en la banda.',
    'Zancada estÃ¡tica con banda':'Con banda bajo el pie delantero y por encima de rodillas, baja zancada manteniendo resistencia.',
    'Remo con banda': 'Pisa la banda, tira con ambos brazos hacia tu cintura manteniendo torso erguido.',
    'Press hombros con banda': 'Pisa la banda y empuja hacia arriba con ambas manos hasta bloquear codos.',
    'Dips en banco con banda': 'Como fondos en banco, pero con banda bajo tus caderas para resistencia extra.',
    'Puente glÃºteo con banda': 'Boca arriba con banda sobre rodillas, eleva cadera apretando y separando ligeramente rodillas.',
    'Patada glÃºteo con banda': 'En cuadrupedia con banda, empuja pierna hacia arriba manteniendo tensiÃ³n lateral.',
    'AbducciÃ³n lateral con banda': 'De pie con banda por encima de rodillas, eleva lateralmente la pierna contra la banda.',
    'Crunch con banda': 'Boca arriba, banda bajo pies, haz crunch elevando hombros manteniendo tensiÃ³n.',
    'Plancha con banda': 'Plancha alta con banda por encima de muÃ±ecas o rodillas para mayor activaciÃ³n.',
    'Mountain climbers con banda': 'Con banda alrededor de pies, lleva rodillas alternas al pecho manteniendo core estable.',
    'Jumping jacks con banda': 'Con banda por encima de rodillas, salta abriendo piernas y manos al nivel del pecho.',
    'Thruster con banda': 'Con banda bajo pies y manos a hombro, baja en sentadilla y empuja hacia arriba estirando brazos.',
    'Gato-vaca': 'En cuadrupedia, alterna arquear (vaca) e hundir (gato) la espalda para movilizar columna.',
    '90/90': 'Sentado con piernas en Ã¡ngulo 90Â°, mantÃ©n posiciÃ³n para mejorar movilidad de caderas.',
    'Rotaciones de tronco':'De pie o sentado, gira el torso llevando manos a un lado y al otro con control.',
    'Remo alto con banda': 'Pisa banda, tira con manos juntas hacia el pecho manteniendo codos altos.',
    'Press militar con banda':'Pisa la banda, empuja de hombros hacia arriba con codos ligeramente delante del cuerpo.',
    'Thruster con banda a una pierna': 'Como thruster, pero sosteniÃ©ndote sobre una pierna mientras empujas arriba.',
    'V-Ups con banda': 'Tumbado con banda en pies y manos juntas, eleva torso y piernas formando V, manteniendo tensiÃ³n.',
    'Crunch bicicleta con banda': 'Crunch bicicleta tradicional aÃ±adiendo banda bajo pies para resistencia extra.',
    'Burpees con salto y banda': 'Burpees normales con banda por encima de rodillas, saltando con resistencia lateral.',
    'Estiramiento de psoas con banda': 'Semi-zancada con banda bajo pie trasero, empuja cadera hacia delante manteniendo tensiÃ³n.',
    'Puente dinÃ¡mico con banda': 'Puente de glÃºteo con banda, eleva y baja cadera sin descansar, manteniendo tensiÃ³n lateral.',
    'Rotaciones dinÃ¡micas de cadera': 'De pie, manos en cadera, haz cÃ­rculos amplios y controlados en ambas direcciones.',
    'Prensa de piernas': 'En la mÃ¡quina, empuja con pies la plataforma estirando piernas sin bloquear rodillas.',
    'Curl femoral tumbado': 'En mÃ¡quina de femorales, flexiona rodillas llevando talones hacia glÃºteos.',
    'ExtensiÃ³n de cuÃ¡driceps': 'En mÃ¡quina, extiende rodillas elevando el rodillo frente a tibias.',
    'JalÃ³n al pecho': 'En polea alta, tira barra al pecho manteniendo codos apuntando al suelo.',
    'Press banca mÃ¡quina': 'En mÃ¡quina, empuja con ambas manos la barra desde el pecho hasta bloqueo de brazos.',
    'Remo sentado': 'En mÃ¡quina, tira manillar hacia tu abdomen manteniendo espalda recta.',
    'AbducciÃ³n cadera mÃ¡quina':'En mÃ¡quina de abductores, separa piernas contra la resistencia manteniendo tronco erguido.',
    'Patada glÃºteo mÃ¡quina': 'En mÃ¡quina con plataforma baja, empuja con el pie la plataforma hacia atrÃ¡s.',
    'Crunch mÃ¡quina': 'En mÃ¡quina de abdominales, flexiona torso acercando pecho a rodillas manteniendo tensiÃ³n.',
    'Plancha en bosu': 'Plancha apoyado sobre bosu, mantÃ©n core firme y cuerpo recto.',
    'ElevaciÃ³n de piernas colgado':'Colgado de barra, eleva piernas dobladas o rectas al pecho y baja controlado.',
    'Kettlebell swing': 'AgÃ¡rrate a kettlebell con ambas manos, balancea entre piernas y luego estira cadera explosivamente.',
    'Burpee con caja': 'Haz burpee normal e impulsa salto sobre una caja de altura moderada.',
    'Thruster con barra': 'Con barra apoyada en hombros, baja en sentadilla frontal y empuja sobre la cabeza.',
    'Sentadilla en mÃ¡quina hack':'En mÃ¡quina hack, apoya espalda y empuja con pies plataforma estirando piernas.',
    'Peso muerto rumano': 'Con barra o mancuernas, baja deslizando peso por piernas manteniendo rodillas ligeramente flexionadas.',
    'Zancada bÃºlgara con mancuernas': 'Con mancuernas en manos, apoya un pie atrÃ¡s en banco y baja sentadilla con pierna delantera.',
    'Press banca barra': 'En banco plano con barra, baja al pecho y empuja hasta bloqueo de brazos.',
    'Dominadas asistidas': 'Con mÃ¡quina o banda, realiza dominadas llevando pecho a la barra controlando la bajada.',
    'Remo con barra T': 'Ancla barra en suelo, agÃ¡rrala con V-bar y tira hacia el pecho manteniendo torso paralelo al suelo.',
    'AbducciÃ³n de cadera en mÃ¡quina': 'Igual que â€œAbducciÃ³n cadera mÃ¡quinaâ€ anterior.',
    'Patada glÃºteo en polea baja': 'Engancha tobillera en polea baja y empuja pierna hacia atrÃ¡s con rodilla flexionada.',
    'Crunch en banco declinado': 'En banco declinado, sujeta manos detrÃ¡s de cabeza, flexiona torso hacia rodillas con control.',
    'Levantamiento de rodillas en paralelas': 'En barra de paralelas, apoya antebrazos, eleva rodillas al pecho manteniendo torso erguido.',
    'Clean and press': 'Levanta barra del suelo al hombro (clean) y de ahÃ­ empuja por encima de la cabeza (press).',
    'Burpee con salto de cajÃ³n': 'Burpee normal cerrado con salto explosivo sobre caja tras Ã©l.',
    'RotaciÃ³n de columna en banco': 'Tumbado en banco lateral, deja caer piernas al lado opuesto para estirar la zona lumbar.',
    'Estiramiento dinÃ¡mico de isquiotibiales': 'De pie, balancea una pierna recta hacia delante y atrÃ¡s controlando el movimiento.',
    'Pistol squat asistida': 'PÃ¡rate en un escalÃ³n o superficie elevada, apoya una mano en un punto fijo (silla o pared) para apoyo y extiende la otra pierna al frente. Flexiona la rodilla de la pierna de trabajo hasta que el muslo quede paralelo al suelo, mantÃ©n torso erguido y vuelve a subir empujando con el talÃ³n.',
    'Sentadilla al aire': 'PÃ¡rate con los pies al ancho de hombros, baja cadera como si te sentaras; mantÃ©n las rodillas alineadas con los dedos de los pies y sube apretando glÃºteos y cuÃ¡driceps.',
    'Zancada estÃ¡tica': 'Da un paso largo hacia adelante y baja ambas rodillas hasta formar dos Ã¡ngulos de 90Â°; empuja con el talÃ³n delantero para volver a la posiciÃ³n inicial manteniendo el core firme.',
      // â€¦ (tus explicaciones actuales) â€¦

  'AbducciÃ³n lateral con salto de banda':
    'Coloca una banda por encima de las rodillas, haz un mini-salto lateral llevando las rodillas hacia afuera, mantÃ©n el core firme.',
  'Burpee con salto':
    'Desde posiciÃ³n de pie baja a plancha, haz un push-up, vuelve pies al pecho y salta explosivamente, aterriza suave.',
  'Dips en banco':
    'Apoya las manos en un banco detrÃ¡s, estira piernas y baja flexionando codos pegados al torso, sube apretando trÃ­ceps.',
  'ElevaciÃ³n de talones a una pierna':
    'De pie, apoya un pie y eleva el talÃ³n de la otra pierna hasta contraer gemelo, baja controlado y alterna.',
  'ElevaciÃ³n de talones con banda':
    'Pisa una banda con ambos pies y, manteniendo tensiÃ³n, sube y baja sÃ³lo con las puntas de los pies.',
  'Estiramiento psoas':
    'En semi-zancada profunda, adelanta cadera manteniendo espalda erguida hasta notar el estirÃ³n en la ingle.',
  'Fondos en banco con banda':
    'Manos en banco, banda bajo caderas para resistencia; baja flexionando codos y sube apretando trÃ­ceps.',
  'Hip Thrust Mariposa':
    'Boca arriba, plantas de pies juntas en mariposa; eleva cadera apretando glÃºteos y baja controlado.',
  'Hip Thrust con pie en banco':
    'Apoya un pie en banco, el otro en suelo; eleva cadera con carga (barra o peso), aprieta glÃºteos arriba.',
  'Hip Thrust en Smith':
    'En mÃ¡quina Smith, apoya espalda alta en banco y empuja barra hacia arriba con cadera, baja suave.',
  'Hip Thrust en una pierna con banda':
    'Tumbado boca arriba, banda por encima de rodillas, eleva cadera apoyando un solo pie y aprieta glÃºteo.',
  'Patada glÃºteo con banda y salto':
    'Banda por encima de rodillas, en cuÃ¡drupeda extiende pierna y al volver haz un pequeÃ±o salto lateral.',
  'Pistol squat asistida con banda':
    'Con banda detrÃ¡s del tobillo y apoyo en una silla, baja en sentadilla a una pierna y sube controlado.',
  'Plancha con apoyo alterno':
    'En posiciÃ³n de plancha alta, alterna levantar un brazo o una pierna manteniendo cuerpo recto y core contraÃ­do.',
  'Plancha lateral':
    'Apoya antebrazo y canto externo del pie, eleva cadera manteniendo lÃ­nea recta de hombro a tobillo.',
  'Plancha lateral con banda':
    'Como la plancha lateral, pero con banda por encima de rodillas para mayor estabilizaciÃ³n.',
  'Press banca mancuernas':
    'Tumbada en banco, empuja mancuernas desde el pecho hasta estirar brazos, controla la bajada.',
  'Puente de glÃºteo con banda':
    'Boca arriba, banda sobre rodillas; eleva cadera apretando glÃºteos y separa rodillas contra banda.',
  'Puente de glÃºteo con una pierna':
    'Misma posiciÃ³n, apoya un pie y eleva cadera estirando la pierna contraria al techo.',
  'Puente glÃºteo con una pierna y banda':
    'Boca arriba con banda, apoya un pie y extiende el otro al subir, aprieta glÃºteos arriba.',
  'Sentadilla bÃºlgara con banda':
    'Pie trasero en banco, con banda bajo el pie delantero y manos al frente, baja a 90Â° y sube.',
  'Sentadilla con salto':
    'Baja en sentadilla explosiva y salta, aterriza suave en semiflexiÃ³n para amortiguar impacto.',
  'Sentadilla con salto con banda':
    'Con banda por encima de rodillas, realiza sentadilla y tras subir haz un salto explosivo.',
  'Thruster con peso corporal':
    'Desde sentadilla frontal lleva manos a hombros al subir y estira brazos sobre cabeza.',
  'Zancada bÃºlgara':
    'Pie trasero elevado, baja la delantera a 90Â° y sube empujando con talÃ³n delantero.',
 
    // â€” Ejercicios de Casa sin material (faltantes) â€”
    'Remo con toalla':'ColÃ³cate debajo de una barra o mesa firme, agÃ¡rrala con ambas manos y tira del pecho hacia arriba manteniendo el cuerpo recto, trabaja espalda y bÃ­ceps.',
    'FlexiÃ³n de pared':'De pie frente a la pared, apoya manos al ancho de hombros y baja el torso controladamente hasta rozar la pared, vuelve a subir estirando brazos para activar pectoral.',
    'AbducciÃ³n mariposa': 'Tumbado boca arriba con plantas juntas (como mariposa), separa ligeramente rodillas para activar abductores y vuelve a la posiciÃ³n inicial.',
    'Jumping Jacks suaves':'De pie, salta abriendo piernas y brazos de forma controlada, aterriza suave y repite para calentar cuerpo entero.',

  // â€” Ejercicios de nivel Intermedio en Casa sin material â€”
  'Zancada caminando': 'Avanza dando zancadas largas, baja rodillas a 90Â° y alterna piernas manteniendo el tronco erguido.',
  'Peso muerto a una pierna': 'Apoya un pie, inclÃ­nate llevando la cadera atrÃ¡s y la pierna opuesta recta atrÃ¡s; sube apretando glÃºteos y isquiotibiales.',
  'Sentadilla bÃºlgara asistida': 'Con un pie sobre un banco detrÃ¡s, baja la otra pierna a 90Â° y sube manteniendo el torso vertical, usa la asistencia de una silla si hace falta.',
  'ElevaciÃ³n de talones': 'De pie, sube y baja sobre las puntas de los pies sintiendo la contracciÃ³n de gemelos.',
  'FlexiÃ³n con rodillas elevadas': 'Apoya rodillas y manos en suelo, baja pecho manteniendo torso recto y sube estirando brazos; para mÃ¡s core, eleva ligeramente caderas.',
  'Hip Thrust a una pierna': 'Tumbado boca arriba, planta un pie y eleva cadera estirando la pierna opuesta al techo, aprieta glÃºteos en la parte alta.',

  // â€” Ejercicios de nivel Avanzado en Casa sin material â€”
  'Burpees': 'Desde de pie, baja a plancha, haz un push-up, vuelve pies cerca de manos y salta explosivo al aire.',
  'Mountain climbers': 'En plancha alta, lleva rodillas alternas al pecho rÃ¡pida y controladamente para activar core y cardio.',
  'Jump squat': 'Baja en sentadilla profunda y salta verticalmente lo mÃ¡s alto posible, aterriza suave y repite.',

  // â€” Ejercicios de Habitacion con bandas â€”
  'Remo con banda': 'Pisa la banda con ambos pies y tira de ella hacia la cintura manteniendo codos cerca del cuerpo, trabaja espalda.',
  'Press hombros con banda': 'Pisa la banda y empuja las manos hacia arriba hasta estirar por completo los codos, activa hombros y trÃ­ceps.',
  'Dips en banco con banda':'Manos en banco, banda bajo caderas para resistencia extra, flexiona codos y sube apretando trÃ­ceps.',
  'Thruster con banda':'Con banda bajo pies, sujeta extremos a hombros; baja en sentadilla y empuja por encima de la cabeza al subir.',
  'Jumping Jacks con banda':'Coloca banda encima de rodillas y haz jumping jacks, mantÃ©n tensiÃ³n constante durante todo el ejercicio.',
  'Rotaciones de cadera': 'De pie, manos en cintura, haz cÃ­rculos amplios y controlados con la pelvis en ambas direcciones.',

  // â€” Ejercicios de Gimnasio con mÃ¡quinas â€”
  'Plancha en bosu':'Coloca antebrazos sobre un bosu y mantÃ©n el cuerpo recto en plancha, aprieta core y glÃºteos.',
  'ElevaciÃ³n de piernas colgado':'Colgado de una barra, eleva las piernas hacia el pecho manteniendo rodillas ligeramente dobladas y baja controlado.',
  'Clean and press':'Levanta la barra del suelo hasta el hombro (clean) y luego empuja sobre la cabeza (press) de forma fluida.',
  'Burpee con caja': 'Realiza un burpee normal e inmediatamente salta sobre una caja de altura moderada, controla la bajada.',
  'RotaciÃ³n de columna en banco': 'Tumbado de lado en banco, deja caer piernas al lado opuesto hasta estirar zona lumbar y vuelve al centro.',
  'Estiramiento de psoas':'En semi-zancada, avanza cadera hacia delante manteniendo espalda recta hasta notar estiramiento profundo de psoas.',

    // ... resto ...
  };

  let chartInstance;

  document.addEventListener('DOMContentLoaded', ()=> {
    const form          = document.getElementById('training-form');
    const actDiv        = document.getElementById('activation-plan');
    const mainDiv       = document.getElementById('main-plan');
    const expDiv        = document.getElementById('express-plan');
    const progDiv       = document.getElementById('progression-plan');
    const chDiv         = document.getElementById('challenge-plan');
    const output        = document.getElementById('output');
    const saveBtn       = document.getElementById('save-session');
    const toggleBtn     = document.getElementById('toggle-history');

    // Toggle historial + chart
    toggleBtn.addEventListener('click', ()=>{
      const histDiv = document.getElementById('historial');
      const chartCan = document.getElementById('progressChart');
      if(histDiv.classList.contains('hidden')){
        verHistorial();
        updateChart();
        histDiv.classList.remove('hidden');
        chartCan.classList.remove('hidden');
        toggleBtn.textContent = 'ğŸ“… Ocultar historial';
      } else {
        histDiv.classList.add('hidden');
        chartCan.classList.add('hidden');
        toggleBtn.textContent = 'ğŸ“… Mostrar historial';
      }
    });

    // Sugerencia sesiÃ³n anterior
    verHistorial();
    const prev = JSON.parse(localStorage.getItem('lastSession')||'null');
    if(prev){
      const alt = getAlternative(prev.goal);
      document.getElementById('suggestion').innerHTML=`
        <div class="bg-purple-200 p-3 rounded text-center mt-4">
          ğŸ‘€ Ayer trabajaste <strong>${prev.goal}</strong>.<br>
          Hoy te recomiendo <strong>${alt}</strong>.
          <div class="mt-2">
            <button onclick="prellenarSugerido('${alt}')" class="bg-green-500 px-2 py-1 rounded text-white mr-2">Aceptar</button>
            <button onclick="alert('ğŸ‘Œ Sugerido rechazado');" class="bg-gray-300 px-2 py-1 rounded text-black">Rechazar</button>
          </div>
        </div>`;
    }
    window.prellenarSugerido = goal => {
  const form = document.getElementById('training-form');
  // 1) Fija el nuevo objetivo
  document.getElementById('goal').value = goal;
  // 2) Oculta los selects ya cumplidos
  document.getElementById('goal-group').style.display = 'none';
  document.getElementById('location-group').style.display = 'none';
  // 3) Oculta la sugerencia
  document.getElementById('suggestion').style.display = 'none';
  // 4) Dispara el submit del formulario para que ejecutar generatePlan() entera
  form.requestSubmit();
};


    // Reto semanal
    const retoLevels = {
      1:'ğŸ”¥ EMOM 5min: burpees + jumping jacks + abdominales',
      2:'ğŸ”¥ AMRAP 6min: zancadas + push-ups + escaladores',
      3:'ğŸ”¥ TABATA 8 rondas: burpees+sentadillas',
      4:'ğŸ”¥ EMOM 6min: flexiones+s.tijera+escaladores',
      5:'ğŸ”¥ AMRAP 7min: squats+abs+burpees'
    };
    let retoLevel = parseInt(localStorage.getItem('retoLevel'))||1;

    // Generador de plan
    function generatePlan(){
      const location = document.getElementById('location').value;
      const level    = document.getElementById('level').value;
      const goal     = document.getElementById('goal').value;
      const time     = +document.getElementById('time').value;
      const energy   = +document.getElementById('energy').value;

        // ActivaciÃ³n
      const activ = ['RespiraciÃ³n nasal profunda','Gato-vaca x10','Bird Dog 3x12','90/90 x30s','Plancha rodillas 3x20s','Marcha en sitio 3x30s'];
      const nAct  = time <= 15 ? 2 : time <= 30 ? 4 : activ.length;
      actDiv.innerHTML = `
  <h3 class="text-lg font-semibold text-purple-600">ğŸ§˜ ActivaciÃ³n inicial</h3>
  <ul class="list-disc ml-5 mt-2">
    ${activ.slice(0,nAct).map(ex=>`
      <li>${ex}
        <button onclick="
          const parts = '${ex}'.split(' ');
          const base  = parts.slice(0,-1).join(' ');
          alert(exerciseInfo['${ex}'] || exerciseInfo[base] || 'ExplicaciÃ³n prÃ³ximamente')
        " class="underline text-blue-500 ml-2 text-sm">â„¹ï¸</button>
      </li>`).join('')}
  </ul>`;


      // Principal
  // 1) Soporta sugerencias compuestas
  let goals = [ goal ];
  if (goal.includes('+')) {
    goals = goal.split('+').map(g => g.trim());
  } else if (goal.includes(' o ')) {
    goals = goal.split(' o ').map(g => g.trim());
  }
  // 2) Normaliza el casing para que coincida con las claves de exerciseBankEnv
  const keyList = Object.keys(exerciseBankEnv[location][level]);
  const matchedGoals = goals.map(g =>
    keyList.find(k => k.toLowerCase() === g.toLowerCase()) || g
  );
  // 3) Construye el pool concatenando todos los objetivos encontrados
  const pool = matchedGoals.reduce((all, k) =>
    all.concat(exerciseBankEnv[location][level][k] || []), []);

  // 4) SelecciÃ³n de ejercicios
  let sel;
  if (goals.length === 1 && goal === 'Cuerpo entero' && time > 30) {
    // un ejercicio de cada categorÃ­a para sesiones largas de cuerpo entero
    sel = Object
      .keys(exerciseBankEnv[location][level])
      .map(cat => shuffle(exerciseBankEnv[location][level][cat])[0]);
  } else {
    // nÃºmero de ejercicios segÃºn tiempo (hasta 60 min)
    const cnt = time <= 15 
              ? 2 
              : time <= 30 
                ? 3 
                : time <= 45 
                  ? 4 
                  : 6;
    sel = shuffle(pool).slice(0, cnt);
  }

 mainDiv.innerHTML = `
  <h3 class="text-lg text-pink-500 font-semibold">ğŸ’ª Entrenamiento principal</h3>
  <ul class="list-disc ml-5 mt-1">
    ${sel.map(ex=>`
      <li>${ex}
        <button onclick="
          const parts = '${ex}'.split(' ');
          const base  = parts.slice(0,-1).join(' ');
          alert(exerciseInfo['${ex}'] || exerciseInfo[base] || 'ExplicaciÃ³n prÃ³ximamente')
        " class="text-pink-300 hover:text-pink-500">â„¹ï¸</button>
      </li>`).join('')}
  </ul>`;


      // Checklist
      document.getElementById('exercise-checklist').innerHTML =
        sel.map(ex => `<label><input type="checkbox" value="${ex}" class="mr-1"> ${ex}</label><br>`).join('');

      // Express
      const exp = shuffle(pool).slice(0, 2);
      expDiv.innerHTML = `
        <h3 class="text-lg text-pink-500 font-semibold">âš¡ Express</h3>
        <ul class="list-disc ml-5 mt-1">
          ${exp.map(ex => `<li>${ex}</li>`).join('')}
        </ul>`;

      // ProgresiÃ³n
      progDiv.innerHTML = `
        <h3 class="text-lg text-green-600 font-semibold">ğŸ“ˆ ProgresiÃ³n</h3>
        <p>Repite en 3 dÃ­as aÃ±adiendo 1 serie o mejorando control.</p>`;

      // Reto
      if(energy>=4){
        chDiv.innerHTML = `
          <h3 class="text-lg text-red-600 font-semibold">ğŸ’¥ Reto: OperaciÃ³n Explosiva</h3>
          <p class="italic">â€œResultados, no excusas.â€</p>
          <p class="mt-2">${retoLevels[retoLevel]}</p>
          <button id="reto-ok" class="mt-3 bg-red-500 text-white px-3 py-1 rounded">âœ… Lo hice</button>
          <button id="reto-no" class="ml-2 mt-3 bg-gray-300 text-black px-3 py-1 rounded">âŒ No hoy</button>`;
        document.getElementById('reto-ok').onclick=()=>{
          retoLevel = Math.min(retoLevel+1,Object.keys(retoLevels).length);
          localStorage.setItem('retoLevel',retoLevel);
          alert('ğŸ”¥ Reto completado!');
        };
        document.getElementById('reto-no').onclick=()=>alert('ğŸ‘Œ Otro dÃ­a.');
      } else {
        chDiv.innerHTML = '';
      }

      // Mostrar + guardar
      output.classList.remove('hidden');
      saveBtn.onclick=()=>{
        localStorage.setItem('lastSession',JSON.stringify({goal,level,location,energy,time,date:new Date().toISOString()}));
        alert('âœ… SesiÃ³n guardada.');
      };
    }

    form.addEventListener('submit', e=>{
      e.preventDefault();
      generatePlan();
    });

    // Feedback
    document.getElementById('save-feedback').onclick=()=>{
      const feeling = document.getElementById('feeling').value.split(' - ')[0];
      const completed = Array.from(document.querySelectorAll('#exercise-checklist input:checked'))
                             .map(i=>i.value).join(', ');
      const hist = JSON.parse(localStorage.getItem('history')||'[]');
      hist.push({date:new Date().toISOString(),completed,feeling:+feeling});
      localStorage.setItem('history',JSON.stringify(hist));
      alert('âœ… Feedback guardado');
      verHistorial();
      updateChart();
    };

    // Init chart
    function updateChart(){
      const hist = JSON.parse(localStorage.getItem('history')||'[]');
      const labels = hist.map(h=>new Date(h.date).toLocaleDateString());
      const data = hist.map(h=>h.feeling);
      const ctx = document.getElementById('progressChart').getContext('2d');
      if(chartInstance) {
        chartInstance.data.labels = labels;
        chartInstance.data.datasets[0].data = data;
        chartInstance.update();
      } else {
        chartInstance = new Chart(ctx, {
          type: 'line',
          data: {
            labels,
            datasets: [{
              label: 'Estado post-entreno (1-5)',
              data,
              fill: false,
              tension: 0.1
            }]
          },
          options: {
            scales: {
              y: { beginAtZero: true, min:1, max:5 }
            }
          }
        });
      }
    }
  });

  // Historial
  function verHistorial(){
    const hist = JSON.parse(localStorage.getItem('history')||'[]');
    const cont = document.getElementById('historial');
    cont.innerHTML = hist.length
      ? hist.map((h,i)=>`
          <div class="mb-2 border-b border-pink-300 pb-2">
            <strong>${new Date(h.date).toLocaleString()}</strong><br>
            <span>âœ… Ejercicios: ${h.completed||'â€”'}</span><br>
            <span>ğŸ’¬ Estado: ${h.feeling}/5</span><br>
            <button onclick="borrarSesion(${i})" class="text-red-400 text-sm underline mt-1">ğŸ—‘ï¸ Borrar</button>
          </div>`).join('')
      : '<p>No hay sesiones guardadas aÃºn.</p>';
  }
  function borrarSesion(idx){
    const h=JSON.parse(localStorage.getItem('history')||'[]');
    h.splice(idx,1);
    localStorage.setItem('history',JSON.stringify(h));
    verHistorial();
    if(window.updateChart) updateChart();
  }
  function exportarMemoria(){
    const data={history:JSON.parse(localStorage.getItem('history')||'[]'),lastSession:localStorage.getItem('lastSession')};
    const blob=new Blob([JSON.stringify(data)],{type:'application/json'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a'); a.href=url; a.download='memoria.json'; a.click();
  }
  function importarMemoria(){
    const f=document.getElementById('importador').files[0];
    if(!f) return alert('Selecciona un JSON primero.');
    const r=new FileReader();
    r.onload=()=>{
      try{
        const d=JSON.parse(r.result);
        if(d.history)     localStorage.setItem('history',JSON.stringify(d.history));
        if(d.lastSession) localStorage.setItem('lastSession',d.lastSession);
        alert('âœ… Importado correctamente.');
        verHistorial();
        if(window.updateChart) updateChart();
      }catch{
        alert('âŒ JSON invÃ¡lido.');
      }
    };
    r.readAsText(f);
  }
  </script>
</body>
</html>
